<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å“¼å“¼çš„å­¦éœ¸ä¹‹è·¯ - å¿«ä¹é—¯å…³ç‰ˆ</title>
    <style>
        :root {
            --primary: #FF8A65;
            --secondary: #4DB6AC;
            --bg-color: #FFF3E0;
            --panel-bg: #FFFFFF;
        }

        body {
            font-family: 'Comic Sans MS', 'Verdana', sans-serif; /* æ›´åœ†æ¶¦çš„å­—ä½“ */
            background-color: var(--bg-color);
            margin: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            user-select: none;
            color: #5D4037;
        }

        /* ç»Ÿä¸€é¡µé¢å®¹å™¨ */
        .page {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            background: var(--bg-color);
            transition: opacity 0.3s;
            z-index: 10;
        }
        .hidden { opacity: 0; pointer-events: none; z-index: -1; }

        /* å¡é€šé£æ ¼æŒ‰é’® */
        .btn {
            padding: 15px 40px; font-size: 1.6rem; font-weight: bold;
            background: var(--primary); color: white;
            border: 4px solid #BF360C; border-radius: 25px;
            cursor: pointer; box-shadow: 0 6px #BF360C;
            margin: 10px; min-width: 180px;
            text-shadow: 1px 1px 0 rgba(0,0,0,0.2);
        }
        .btn:active { transform: translateY(4px); box-shadow: 0 2px #BF360C; }

        /* å·¦ä¸Šè§’è¿”å›é”® (ç»å¯¹å®šä½ï¼Œè¿œç¦»è¡€æ¡) */
        .btn-back {
            position: absolute; top: 15px; left: 15px;
            width: 55px; height: 55px; border-radius: 50%;
            background: var(--secondary); border: 3px solid #00796B;
            font-size: 30px; color: white;
            display: flex; justify-content: center; align-items: center;
            cursor: pointer; z-index: 100; box-shadow: 0 4px #004D40;
        }
        .btn-back:active { transform: translateY(2px); box-shadow: 0 1px #004D40; }

        /* é¡¶éƒ¨ HUD çŠ¶æ€æ  (ä¸“é—¨çš„åŒºåŸŸï¼Œå±…ä¸­æ˜¾ç¤º) */
        #game-header {
            position: absolute; top: 10px; left: 80px; right: 80px; /* å·¦å³ç•™å‡ºç©ºé—´ */
            height: 60px;
            background: rgba(255,255,255,0.9);
            border-radius: 30px;
            border: 3px solid #8D6E63;
            display: flex; justify-content: space-around; align-items: center;
            z-index: 90;
            box-shadow: 0 4px rgba(0,0,0,0.1);
        }

        .hud-item { font-size: 1.3rem; font-weight: bold; display: flex; align-items: center; gap: 5px; }
        
        /* å¿ƒå½¢è¡€æ¡æ ·å¼ */
        #hp-container { letter-spacing: 2px; font-size: 1.5rem; }

        /* æ¸¸æˆåŒºåŸŸ */
        #game-area {
            width: 92%; height: 75%; /* ç»™é¡¶éƒ¨ç•™å‡ºç©ºé—´ */
            margin-top: 70px; /* é¿å¼€é¡¶éƒ¨æ  */
            background: #FFECB3; /* æš–é»„è‰²èƒŒæ™¯ï¼Œåƒæ²™åœ° */
            border-radius: 20px;
            border: 5px solid #FFCA28;
            box-shadow: inset 0 0 30px rgba(0,0,0,0.1);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            position: relative;
        }

        canvas { border-radius: 10px; background: transparent; max-width: 100%; max-height: 100%; }
        
        /* åŠ¨ç”»ç‰¹æ•ˆ */
        .shake { animation: shake 0.3s; border-color: #ff4444 !important; }
        @keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-8px)} 75%{transform:translateX(8px)} }

        /* å¼¹çª—ä¼˜åŒ– */
        .modal-content {
            background: #FFF; border: 5px solid var(--secondary);
            border-radius: 30px; padding: 30px; text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            width: 85%; max-width: 400px;
        }

        /* ç­”é¢˜å¡ä¼˜åŒ– */
        .quiz-box { width: 100%; padding: 10px; box-sizing: border-box; }
        .question { font-size: 3rem; font-weight: bold; color: #3E2723; margin: 20px 0; }
        .options { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .opt-btn {
            background: white; border: 3px solid #BCAAA4;
            padding: 20px; font-size: 1.8rem; border-radius: 20px;
            color: #5D4037;
        }
    </style>
</head>
<body>

<div id="app">
    <div id="page-login" class="page" style="background: linear-gradient(to bottom, #81D4FA, #E1F5FE);">
        <h1 style="font-size:3rem; color:#01579B; text-shadow: 2px 2px white;">ğŸ“ å“¼å“¼çš„å­¦éœ¸ä¹‹è·¯</h1>
        <div style="font-size: 6rem; margin: 20px;">ğŸ’</div>
        <input type="text" value="å“¼å“¼" style="font-size:1.5rem; padding:10px; border-radius:15px; border:3px solid #0288D1; text-align:center; width:200px; margin-bottom:20px;">
        <button class="btn" onclick="navTo('page-monster')">å¼€å§‹å¤§å†’é™©</button>
    </div>

    <div id="page-monster" class="page hidden">
        <div class="btn-back" onclick="navTo('page-login')">â¬…</div>
        <h1 style="margin-top:60px">é€‰ä¸€ä¸ªä¼™ä¼´å‡ºå‘ï¼</h1>
        <div style="display:flex; gap:20px; flex-wrap:wrap; justify-content:center;">
            <div onclick="selectMonster('ğŸ²')" style="background:white; padding:20px; border-radius:20px; border:4px solid #ddd; cursor:pointer;">
                <div style="font-size:4rem">ğŸ²</div>
                <div style="text-align:center; font-weight:bold; margin-top:5px;">å–·ç«é¾™</div>
            </div>
            <div onclick="selectMonster('ğŸ¤–')" style="background:white; padding:20px; border-radius:20px; border:4px solid #ddd; cursor:pointer;">
                <div style="font-size:4rem">ğŸ¤–</div>
                <div style="text-align:center; font-weight:bold; margin-top:5px;">æœºç”²æˆ˜å£«</div>
            </div>
        </div>
    </div>

    <div id="page-menu" class="page hidden">
        <div class="btn-back" onclick="navTo('page-monster')">â¬…</div>
        <h1 style="margin-top:60px">è¦å»å“ªé‡Œæ¢é™©ï¼Ÿ</h1>
        <div style="display:flex; flex-direction:column; gap:15px;">
            <button class="btn" style="background:#FFA726" onclick="startGame('maze')">ğŸ”® è¿·å®«æ¢é™©</button>
            <button class="btn" style="background:#42A5F5" onclick="startGame('math')">ğŸ”¢ æ•°å­¦æ“‚å°</button>
            <button class="btn" style="background:#66BB6A" onclick="startGame('memory')">ğŸ§  è®°å¿†å¤§å¸ˆ</button>
        </div>
    </div>

    <div id="page-game" class="page hidden">
        <div class="btn-back" onclick="confirmExit()">ğŸ </div>

        <div id="game-header">
            <div class="hud-item" style="color:#D32F2F;">
                <span id="hp-container">â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸</span>
            </div>
            <div class="hud-item" style="color:#F57C00;">
                â­ <span id="score-val">0</span>
            </div>
            <div class="hud-item" style="color:#0288D1; font-size:1rem;">
                ç¬¬ <span id="level-num">1</span> å…³
            </div>
        </div>

        <div id="game-area">
            <div id="game-content" style="width:100%; height:100%; display:flex; justify-content:center; align-items:center;"></div>
        </div>
        
        <div id="msg-area" style="position:absolute; bottom:20px; color:#795548; font-weight:bold; font-size:1.2rem;"></div>
    </div>

    <div id="modal" class="hidden" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); display:flex; justify-content:center; align-items:center; z-index:200;">
        <div class="modal-content">
            <h2 id="modal-title" style="font-size:2rem; margin:10px 0;"></h2>
            <div id="modal-icon" style="font-size:5rem; margin:20px;"></div>
            <p id="modal-msg" style="font-size:1.4rem; color:#555;"></p>
            <button class="btn" id="btn-next">ç»§ç»­</button>
        </div>
    </div>
</div>

<script>
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    
    function playTone(freq, type, dur) {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + dur);
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.start(); osc.stop(audioCtx.currentTime + dur);
    }

    function playSound(name) {
        if (name === 'win') { playTone(600, 'sine', 0.2); setTimeout(()=>playTone(800,'sine',0.4), 100); }
        if (name === 'wrong') { playTone(150, 'sawtooth', 0.4); }
        if (name === 'boom') { playTone(80, 'square', 0.5); } // ç‚¸å¼¹
        if (name === 'eat') { playTone(1000, 'sine', 0.1); } // åƒè‹¹æœ
        if (name === 'wall') { playTone(100, 'triangle', 0.1); } // æ’å¢™
    }
</script>

<script>
    const state = { monster: 'ğŸ²', hp: 5, maxHp: 5, score: 0, level: 1, mode: '', hasRocket: false };

    function navTo(page) {
        document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
        document.getElementById(page).classList.remove('hidden');
    }
    
    function selectMonster(m) { state.monster = m; navTo('page-menu'); }
    
    function confirmExit() { if(confirm("è¦å›å¤§å…å—ï¼Ÿ")) navTo('page-menu'); }

    function startGame(mode) {
        state.mode = mode; state.level = 1; state.score = 0; state.hp = 5; state.hasRocket = false;
        navTo('page-game');
        updateHUD();
        loadLevel();
    }

    // --- UI æ¸²æŸ“æ ¸å¿ƒï¼šç”»çº¢å¿ƒ ---
    function updateHUD() {
        // æ¸²æŸ“è¡€æ¡ï¼šæ»¡è¡€5é¢—å¿ƒ
        let heartsHtml = '';
        for(let i=0; i<state.maxHp; i++) {
            if(i < state.hp) heartsHtml += 'â¤ï¸';
            else heartsHtml += 'ğŸ¤'; // ç©ºå¿ƒä»£è¡¨æ‰£è¡€
        }
        document.getElementById('hp-container').innerHTML = heartsHtml;
        document.getElementById('score-val').innerText = state.score;
        document.getElementById('level-num').innerText = state.level;
        
        let msg = "åŠ æ²¹ï¼å“¼å“¼ï¼";
        if(state.hasRocket) msg = "ğŸš€ ç«ç®­å°±ç»ªï¼æ’å¢™å¯ä»¥ç ´å£ï¼";
        if(state.hp <= 2) msg = "âš ï¸ å°å¿ƒï¼è¡€é‡ä¸å¤šäº†ï¼Œå¿«æ‰¾è‹¹æœï¼";
        document.getElementById('msg-area').innerText = msg;
    }

    function updateHP(delta) {
        state.hp += delta;
        if(state.hp > state.maxHp) state.hp = state.maxHp;
        updateHUD();
        if(state.hp <= 0) showModal(false, "æ²¡åŠ›æ°”äº†...", "ä¼‘æ¯ä¸€ä¸‹å†è¯•ä¸€æ¬¡å§ï¼");
    }

    function loadLevel() {
        const container = document.getElementById('game-content');
        container.innerHTML = '';
        updateHUD();
        state.hasRocket = false; // æ¯å…³é‡ç½®é“å…·
        
        if(state.mode === 'maze') initMaze(container);
        else if(state.mode === 'math') initMath(container);
        else initMemory(container);
    }

    function showModal(isWin, title, msg) {
        const modal = document.getElementById('modal');
        modal.classList.remove('hidden');
        document.getElementById('modal-title').innerText = title;
        document.getElementById('modal-msg').innerText = msg;
        document.getElementById('modal-icon').innerText = isWin ? "ğŸ†" : "ğŸ˜¢";
        
        const btn = document.getElementById('btn-next');
        if(isWin) {
            btn.innerText = "ä¸‹ä¸€å…³";
            btn.onclick = () => { modal.classList.add('hidden'); nextLevel(); };
        } else {
            btn.innerText = "é‡æ–°å¼€å§‹";
            btn.onclick = () => { modal.classList.add('hidden'); startGame(state.mode); };
        }
    }

    function nextLevel() {
        if(state.level >= 6) {
            alert("é€šå…³å•¦ï¼å¤ªå‰å®³äº†ï¼");
            navTo('page-menu');
            return;
        }
        state.level++;
        state.hp = Math.min(state.hp + 1, 5); // è¿‡å…³å›ä¸€è¡€
        loadLevel();
    }

    // --- 1. è¿·å®«é€»è¾‘ (æ ¸å¿ƒä¿®å¤ï¼šé˜²æ­¢æ­»è·¯) ---
    function initMaze(container) {
        const canvas = document.createElement('canvas');
        container.appendChild(canvas);
        const ctx = canvas.getContext('2d');
        
        // åŠ¨æ€è®¡ç®—æ ¼å­å¤§å°
        let cols = 6 + state.level; 
        let rows = 6 + state.level;
        let size = Math.min(container.clientWidth / cols, container.clientHeight / rows) * 0.95;
        canvas.width = cols * size; canvas.height = rows * size;

        // ç”ŸæˆåŸºç¡€è¿·å®«
        let maze = Array(cols).fill().map(()=>Array(rows).fill().map(()=>({t:1,r:1,b:1,l:1,v:0, item:null})));
        let stack=[{x:0,y:0}]; maze[0][0].v=1;
        while(stack.length){
            let c=stack[stack.length-1];
            let n=[[0,-1,'t','b'],[1,0,'r','l'],[0,1,'b','t'],[-1,0,'l','r']].map(d=>({x:c.x+d[0],y:c.y+d[1],d})).filter(p=>p.x>=0&&p.x<cols&&p.y>=0&&p.y<rows&&!maze[p.x][p.y].v);
            if(n.length){
                let next=n[Math.floor(Math.random()*n.length)];
                maze[c.x][c.y][next.d[2]]=0; maze[next.x][next.y][next.d[3]]=0;
                maze[next.x][next.y].v=1; stack.push({x:next.x,y:next.y});
            }else stack.pop();
        }

        // --- å…³é”®ä¿®å¤ï¼šæ‰“é€šæ­»è·¯ (å¤šè·¯å¾„æœºåˆ¶) ---
        // éšæœºç§»é™¤ 30% çš„å¢™å£ï¼Œå½¢æˆç¯è·¯ï¼Œè¿™æ ·é‡åˆ°ç‚¸å¼¹å¯ä»¥ç»•è·¯
        let totalCells = cols * rows;
        let removeCount = Math.floor(totalCells * 0.3); 
        for(let i=0; i<removeCount; i++) {
            let rx = Math.floor(Math.random()*(cols-2)) + 1; // ä¸ç ´åè¾¹ç•Œ
            let ry = Math.floor(Math.random()*(rows-2)) + 1;
            // éšæœºæ‰“é€šå³è¾¹æˆ–ä¸‹è¾¹çš„å¢™
            if(Math.random()>0.5) { maze[rx][ry].r=0; maze[rx+1][ry].l=0; }
            else { maze[rx][ry].b=0; maze[rx][ry+1].t=0; }
        }

        // --- æ”¾ç½®ç‰©å“ (æ§åˆ¶æ•°é‡) ---
        // 1. æ”¾ç½®ç‚¸å¼¹ (æ•°é‡å¾ˆå°‘ï¼šç­‰çº§+1ï¼Œæœ€å¤š3ä¸ª)
        let bombCount = Math.min(state.level + 1, 4); 
        while(bombCount > 0) {
            let x = Math.floor(Math.random()*cols), y = Math.floor(Math.random()*rows);
            // ä¸åœ¨èµ·ç‚¹ã€ç»ˆç‚¹æ”¾
            if((x+y > 2) && !(x===cols-1 && y===rows-1) && !maze[x][y].item) {
                maze[x][y].item = 'ğŸ’£'; bombCount--;
            }
        }
        
        // 2. æ”¾ç½®è‹¹æœ (æ•°é‡å¿…é¡»æ¯”ç‚¸å¼¹å¤šï¼)
        let foodCount = bombCount + 3; 
        while(foodCount > 0) {
            let x = Math.floor(Math.random()*cols), y = Math.floor(Math.random()*rows);
            if(!maze[x][y].item) { maze[x][y].item = 'ğŸ'; foodCount--; }
        }

        // 3. å¿…æœ‰ç«ç®­
        while(true){
            let x = Math.floor(Math.random()*cols), y = Math.floor(Math.random()*rows);
            if(!maze[x][y].item) { maze[x][y].item = 'ğŸš€'; break; }
        }

        let px=0, py=0;

        function draw() {
            ctx.clearRect(0,0,canvas.width,canvas.height);
            // ç”»æ ¼å­èƒŒæ™¯
            ctx.fillStyle = "rgba(255,255,255,0.5)";
            
            // ç”»å¢™
            ctx.strokeStyle = "#795548"; ctx.lineWidth = 4; ctx.lineCap = "round";
            ctx.beginPath();
            for(let x=0; x<cols; x++) for(let y=0; y<rows; y++) {
                let X=x*size, Y=y*size;
                let c = maze[x][y];
                if(c.t){ctx.moveTo(X,Y);ctx.lineTo(X+size,Y);}
                if(c.r){ctx.moveTo(X+size,Y);ctx.lineTo(X+size,Y+size);}
                if(c.b){ctx.moveTo(X,Y+size);ctx.lineTo(X+size,Y+size);}
                if(c.l){ctx.moveTo(X,Y);ctx.lineTo(X,Y+size);}
                
                // ç‰©å“
                if(c.item) {
                    ctx.font = `${size*0.6}px Arial`; ctx.textAlign='center'; ctx.textBaseline='middle';
                    ctx.fillText(c.item, X+size/2, Y+size/2);
                }
            }
            ctx.stroke();

            // ç©å®¶
            ctx.font = `${size*0.7}px Arial`; ctx.textAlign='center'; ctx.textBaseline='middle';
            ctx.fillText(state.monster, px*size+size/2, py*size+size/2+4);
            // ç»ˆç‚¹
            ctx.fillText("ğŸš©", (cols-1)*size+size/2, (rows-1)*size+size/2);
            
            // ç«ç®­ç‰¹æ•ˆåœˆ
            if(state.hasRocket) {
                ctx.strokeStyle="gold"; ctx.lineWidth=3; ctx.beginPath();
                ctx.arc(px*size+size/2, py*size+size/2, size*0.4, 0, Math.PI*2);
                ctx.stroke();
            }
        }
        draw();

        // ç§»åŠ¨é€»è¾‘
        const move = (dx,dy) => {
            let nx=px+dx, ny=py+dy;
            if(nx<0||nx>=cols||ny<0||ny>=rows) return;
            
            let c=maze[px][py];
            // æ’å¢™æ£€æµ‹
            let blocked = false;
            if(dx===1 && c.r) blocked=true;
            if(dx===-1 && c.l) blocked=true;
            if(dy===1 && c.b) blocked=true;
            if(dy===-1 && c.t) blocked=true;

            if(blocked) {
                if(state.hasRocket) { // ç ´å¢™
                    playSound('boom');
                    if(dx===1){maze[px][py].r=0; maze[nx][ny].l=0;}
                    if(dx===-1){maze[px][py].l=0; maze[nx][ny].r=0;}
                    if(dy===1){maze[px][py].b=0; maze[nx][ny].t=0;}
                    if(dy===-1){maze[px][py].t=0; maze[nx][ny].b=0;}
                    state.hasRocket=false;
                    updateHUD(); draw();
                } else {
                    playSound('wall');
                    canvas.classList.add('shake');
                    setTimeout(()=>canvas.classList.remove('shake'), 300);
                }
            } else {
                px=nx; py=ny;
                if(maze[px][py].item) {
                    let it = maze[px][py].item;
                    maze[px][py].item = null;
                    if(it==='ğŸ’£'){ playSound('boom'); updateHP(-1); canvas.classList.add('shake'); setTimeout(()=>canvas.classList.remove('shake'),300); }
                    if(it==='ğŸ'){ playSound('eat'); updateHP(1); }
                    if(it==='ğŸš€'){ playSound('eat'); state.hasRocket=true; updateHUD(); }
                }
                draw();
                if(px===cols-1 && py===rows-1) showModal(true, "æŠµè¾¾ç»ˆç‚¹ï¼", "è¿·å®«æŒ‘æˆ˜æˆåŠŸï¼");
            }
        };

        // è§¦æ§æ”¯æŒ
        canvas.onclick = e => {
            let r=canvas.getBoundingClientRect();
            let tx=e.clientX-r.left-(px*size+size/2);
            let ty=e.clientY-r.top-(py*size+size/2);
            if(Math.abs(tx)>Math.abs(ty)) move(tx>0?1:-1,0); else move(0,ty>0?1:-1);
        };
        // é”®ç›˜æ”¯æŒ
        window.onkeydown = e => {
            if(state.mode==='maze') {
                if(e.key==='ArrowUp') move(0,-1);
                if(e.key==='ArrowDown') move(0,1);
                if(e.key==='ArrowLeft') move(-1,0);
                if(e.key==='ArrowRight') move(1,0);
            }
        }
    }

    // --- 2. æ•°å­¦é¢˜ (å¤ç”¨æ—§é€»è¾‘) ---
    function initMath(container) {
        let max = state.level * 5 + 5;
        let a = Math.floor(Math.random()*max), b = Math.floor(Math.random()*max), isPlus = Math.random()>0.5;
        if(!isPlus && a<b) [a,b]=[b,a];
        let ans = isPlus ? a+b : a-b;
        let opts = [ans, ans+1, ans-1, ans+2].sort(()=>Math.random()-0.5);
        
        container.innerHTML = `
            <div class="quiz-box">
                <div class="question">${a} ${isPlus?'+':'-'} ${b} = ?</div>
                <div class="options">
                    ${opts.map(o=>`<button class="opt-btn" onclick="checkMath(this, ${o}, ${ans})">${o}</button>`).join('')}
                </div>
            </div>`;
    }
    function checkMath(btn, val, ans) {
        if(val===ans) { playSound('win'); state.score+=10; showModal(true, "ç®—å¯¹å•¦ï¼", "æ•°å­¦å°å¤©æ‰ï¼"); }
        else { playSound('wrong'); btn.style.background="#ffcdd2"; updateHP(-1); }
    }

    // --- 3. è®°å¿†å¤§å¸ˆ (å¤ç”¨æ—§é€»è¾‘) ---
    function initMemory(container) {
        // ç®€åŒ–ç‰ˆï¼šåªéœ€é…å¯¹ä¸€æ¬¡å³å¯è¿‡å…³ï¼ˆæ¼”ç¤ºç”¨ï¼‰
        let icons = ['ğŸ¶','ğŸ±','ğŸ­','ğŸ¹'].slice(0, 1 + state.level);
        let cards = [...icons, ...icons].sort(()=>Math.random()-0.5);
        
        container.innerHTML = `
            <div style="display:grid; grid-template-columns:repeat(4,1fr); gap:10px;">
                ${cards.map((icon,i) => `<div id="card-${i}" onclick="flipCard(${i}, '${icon}')" style="width:60px; height:80px; background:#4DB6AC; border-radius:10px; font-size:0;">${icon}</div>`).join('')}
            </div>`;
    }
    let flipped = [];
    function flipCard(i, icon) {
        let el = document.getElementById(`card-${i}`);
        if(el.style.background === 'white' || flipped.length >= 2) return;
        
        el.style.background = 'white';
        el.style.fontSize = '3rem';
        el.innerText = icon; // æ˜¾ç¤º
        flipped.push({i, icon, el});
        
        if(flipped.length === 2) {
            if(flipped[0].icon === flipped[1].icon) {
                playSound('win');
                flipped = [];
                // æ£€æŸ¥æ˜¯å¦å…¨å®Œäº†ï¼ˆè¿™é‡Œç®€å•åˆ¤èµ¢ï¼‰
                setTimeout(()=>showModal(true, "è®°å¿†åŠ›è¶…æ£’ï¼", "è¿‡å…³ï¼"), 500);
            } else {
                updateHP(-1);
                setTimeout(() => {
                    flipped.forEach(item => {
                        item.el.style.background = '#4DB6AC';
                        item.el.innerText = ''; // éšè—
                    });
                    flipped = [];
                }, 1000);
            }
        }
    }

</script>
</body>
</html>